<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vizcaya Weather Hub (Live)</title>
    <!-- SunCalc.js library for accurate sunrise/sunset times -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/suncalc/1.8.0/suncalc.min.js"></script>
    <style>
        /* General Body Styling */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #121212; /* Dark background */
            color: #ffffff;
            margin: 0;
            padding: 0;
        }

        /* Header Styling */
        .header {
            background-color: #1F1F1F;
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid #007BFF;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            color: #ffffff;
        }
        .header p {
            margin: 5px 0 0;
            font-size: 1.1em;
            color: #b0b0b0;
        }
        
        /* Live Data Header Styling */
        .live-data-header {
            margin-top: 15px;
            font-size: 1.1em;
            color: #00BFFF;
        }
        .live-data-header .time {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
        }
        .live-data-header .sun-info {
            font-size: 0.9em;
            color: #b0b0b0;
            margin-top: 5px;
        }

        /* Live Threat Bar Styling */
        .threat-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 15px;
            background-color: #1F1F1F;
            border-bottom: 1px solid #444;
        }
        .threat-item {
            flex: 1;
            min-width: 300px;
            background-color: #2A2A2A;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 15px;
            height: 250px; 
            overflow-y: auto; 
            scrollbar-color: #555 #2A2A2A;
        }
        .threat-item h2 {
            margin-top: 0;
            font-size: 1.4em;
            color: #00BFFF;
            text-align: center;
        }
        .threat-item div, .threat-item div a, .threat-item div b {
            color: #eee !important;
            font-size: 0.9em !important;
            background-color: transparent !important;
        }
        .threat-item div a {
            text-decoration: underline !important;
        }
        .threat-item div b {
            color: #00BFFF !important;
        }

        /* Main Content Container */
        .container {
            padding: 25px;
        }

        /* Weather Station Widget Styling */
        .weather-station-widget {
            background-color: #2A2A2A;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        .weather-station-widget h2 {
            margin-top: 0;
            font-size: 1.6em;
            color: #00BFFF;
            text-align: center;
            margin-bottom: 20px;
        }
        .weather-station-widget iframe {
            width: 100%;
            height: 700px;
            border: 0;
        }
        
        /* Section Header Styling */
        .section-header {
            font-size: 2em;
            color: #00BFFF;
            border-bottom: 2px solid #007BFF;
            padding-bottom: 10px;
            margin-top: 40px;
            margin-bottom: 25px;
        }
        hr.section-divider {
            border: 0;
            height: 1px;
            background-image: linear-gradient(to right, rgba(0, 123, 255, 0), rgba(0, 123, 255, 0.75), rgba(0, 123, 255, 0));
            margin: 50px 0;
        }

        /* Grid Styling */
        .image-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }
        @media (min-width: 768px) {
            .image-grid { grid-template-columns: repeat(2, 1fr); }
        }
        @media (min-width: 1200px) {
            .image-grid { grid-template-columns: repeat(3, 1fr); }
        }

        /* Individual Image Card Styling */
        .grid-item {
            background-color: #2A2A2A;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
        }
        .grid-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 123, 255, 0.2);
        }
        .grid-item h2 {
            margin-top: 0;
            font-size: 1.4em;
            color: #00BFFF;
        }
        .grid-item img, .grid-item iframe {
            max-width: 100%;
            height: auto;
            flex-grow: 1;
            border-radius: 5px;
            border: 1px solid #555;
            background-color: #1c1c1c; 
            object-fit: contain;
        }
        .grid-item iframe {
            height: 400px;
            object-fit: initial;
        }
        .grid-item a {
            text-decoration: none;
            color: inherit;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }
        
        /* Custom Season Widget Styling */
        .season-widget-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            font-size: 1.1em;
        }
        .season-list {
            list-style: none;
            padding: 0;
            text-align: left;
        }
        .season-list li {
            margin-bottom: 10px;
        }
        .countdown {
            font-size: 1.4em;
            font-weight: bold;
            margin-top: 20px;
            color: #00BFFF;
        }

        /* Footer Styling */
        .footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: #888;
            font-size: 0.9em;
            border-top: 1px solid #333;
        }

    </style>
</head>
<body>

    <header class="header">
        <h1>Vizcaya Weather Hub</h1>
        <p>A centralized dashboard of live NWS and NOAA satellite and forecast imagery.</p>
        <div class="live-data-header">
            <div id="currentDate"></div>
            <div id="currentTime" class="time"></div>
            <div id="sunInfo" class="sun-info"></div>
        </div>
    </header>

    <div class="threat-bar">
        <div class="threat-item">
            <h2>Local NWS Alerts</h2>
            <script src="//rss.bloople.net/?url=https%3A%2F%2Falerts.weather.gov%2Fcap%2Fwwaatmget.php%3Fx%3DTXC491%26y%3D0&detail=100&limit=5&showtitle=false&type=js"></script>
        </div>
        <div class="threat-item">
            <h2>NHC Advisories</h2>
            <script src="//rss.bloople.net/?url=https%3A%2F%2Fwww.nhc.noaa.gov%2Findex-at.xml&detail=100&limit=5&showtitle=false&type=js"></script>
        </div>
        <div class="threat-item">
            <h2>SPC Products</h2>
            <script src="//rss.bloople.net/?url=https%3A%2F%2Fwww.spc.noaa.gov%2Fproducts%2Fspcrss.xml&detail=100&limit=5&showtitle=false&type=js"></script>
        </div>
    </div>

    <div class="container">

        <!-- Full-Width Weather Station -->
        <div class="weather-station-widget">
            <h2>Live from the Vizcaya Weather Station</h2>
            <iframe src="https://www.weatherlink.com/embeddablePage/show/9bbf4c3bf5064d48aeb400f026712926/fullscreen"></iframe>
        </div>

        <hr class="section-divider">

        <!-- Section 1: Live Threats & Local Conditions -->
        <h2 class="section-header">Live Threats & Local Conditions</h2>
        <div class="image-grid">
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/md/" target="_blank">
                    <h2>Mesoscale Discussions (SPC)</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/md/validmd.png" alt="SPC Mesoscale Discussions">
                </a>
            </div>
             <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/watch/" target="_blank">
                    <h2>Current Watches (SPC)</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/watch/validww.png" alt="Current SPC Watches">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.wpc.ncep.noaa.gov/metwatch/metwatch_mpd.php" target="_blank">
                    <h2>Mesoscale Precipitation Discussions</h2>
                    <img class="weather-image" src="https://www.wpc.ncep.noaa.gov/metwatch/latest_mdmap.gif" alt="WPC Mesoscale Precipitation Discussions Map">
                </a>
            </div>
            <div class="grid-item">
                <h2>Live Weather Summary</h2>
                <iframe src="https://www.weatherlink.com/embeddablePage/show/d318c2a4245b47fa955bd8f9ed3b22c2/summary" title="Live Weather Summary from Vizcaya Station"></iframe>
            </div>
            <div class="grid-item">
                <h2>Vizcaya 7-Day Forecast</h2>
                <iframe src="https://forecast.weather.gov/MapClick.php?lat=30.6476&lon=-97.6863&unit=0&lg=english&FcstType=text&TextType=1" title="7-Day Forecast for Vizcaya, TX"></iframe>
            </div>
            <div class="grid-item">
                <h2>Seasons Countdown</h2>
                <div class="season-widget-content">
                    <ul class="season-list">
                        <li><strong>Spring:</strong> <span id="springDate"></span></li>
                        <li><strong>Summer:</strong> <span id="summerDate"></span></li>
                        <li><strong>Fall:</strong> <span id="fallDate"></span></li>
                        <li><strong>Winter:</strong> <span id="winterDate"></span></li>
                    </ul>
                    <div id="nextSeasonCountdown" class="countdown"></div>
                </div>
            </div>
        </div>

        <hr class="section-divider">

        <!-- Section 2: Live Satellite & Radar -->
        <h2 class="section-header">Live Satellite & Radar</h2>
        <div class="image-grid">
             <div class="grid-item">
                <a href="https://radar.weather.gov/?settings=v1_eyJhZ2VuZGEiOnsiaWQiOiJsb2NhbCIsImNlbnRlciI6[-97.67,30.51],"bG9jYXRpb24iOltdLCJ6b29tIjo5fSwiYW5pbWF0aW5nIjpmYWxzZSwiYmFzZSI6InN0YW5kYXJkIiwiYXJ0Y2MiOmZhbHNlLCJjb3VudHkiOmZhbHNlLCJjd2EiOmZhbHNlLCJyaXZlcl9wcm9qIjpmYWxzZSwicmZjIjpmYWxzZSwic3RhdGUiOmZhbHNlLCJ0aW1lIjowLCJkZXRhaWwiOmZhbHNlLCJzaG9ydF9mdXNlZE9ubHkiOnRydWUsIm9wYWNpdHkiOnsiYWxlcnRzIjowLjgsImxvY2FsIjowLjYsImxvY2FsU3RhdGlvbnMiOjAuOCwibmF0aW9uYWwiOjAuNn19" target="_blank">
                    <h2>Live Local Radar Loop</h2>
                    <img class="weather-image" src="https://radar.weather.gov/ridge/standard/KGRK_0.gif" alt="Live Austin/San Antonio Radar Loop">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.wunderground.com/maps/radar/current" target="_blank">
                    <h2>U.S. Satellite & Radar Loop</h2>
                    <img class="weather-image" src="https://s.w-x.co/staticmaps/wu/wu/wxtype1200_cur/ussat/animate.png" alt="Weather Underground U.S. Satellite and Radar">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://radar.weather.gov/ridge/radar.php?rid=STR&product=N0R&overlay=11101111&loop=yes" target="_blank">
                    <h2>Southern Plains Radar Loop</h2>
                    <img class="weather-image" src="https://radar.weather.gov/ridge/standard/SOUTHPLAINS_0.gif" alt="Southern Plains Radar Loop">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://cdn.star.nesdis.noaa.gov/GOES19/ABI/SECTOR/sp/GEOCOLOR/latest.jpg" target="_blank">
                    <h2>GOES-19 - Southern Plains</h2>
                    <img class="weather-image" src="https://cdn.star.nesdis.noaa.gov/GOES19/ABI/SECTOR/sp/GEOCOLOR/latest.jpg" alt="GOES-19 Southern Plains Satellite Image">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://cdn.star.nesdis.noaa.gov/GOES19/ABI/SECTOR/sp/08/latest.jpg" target="_blank">
                    <h2>GOES-19 - Water Vapor</h2>
                    <img class="weather-image" src="https://cdn.star.nesdis.noaa.gov/GOES19/ABI/SECTOR/sp/08/latest.jpg" alt="GOES-19 Water Vapor Satellite Image">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://cdn.star.nesdis.noaa.gov/GOES19/ABI/SECTOR/sp/13/latest.jpg" target="_blank">
                    <h2>GOES-19 - Infrared</h2>
                    <img class="weather-image" src="https://cdn.star.nesdis.noaa.gov/GOES19/ABI/SECTOR/sp/13/latest.jpg" alt="GOES-19 Infrared Satellite Image">
                </a>
            </div>
        </div>

        <hr class="section-divider">

        <!-- Section 3: Tropical & Marine -->
        <h2 class="section-header">Tropical & Marine</h2>
        <div class="image-grid">
            <div class="grid-item">
                <a href="https://www.nhc.noaa.gov/" target="_blank">
                    <h2>Tropical Weather Outlook</h2>
                    <img class="weather-image" src="https://www.nhc.noaa.gov/xgtwo/two_atl_7d0.png" alt="National Hurricane Center Tropical Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.star.nesdis.noaa.gov/GOES/sector.php?sat=G19¬ßor=taw" target="_blank">
                    <h2>GOES-19 - Full Atlantic</h2>
                    <img class="weather-image" src="https://cdn.star.nesdis.noaa.gov/GOES19/ABI/SECTOR/taw/GEOCOLOR/900x540.jpg" alt="GOES-19 Full Atlantic Satellite Image">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.cpc.ncep.noaa.gov/products/precip/CWlink/ghazards/ghaz.shtml" target="_blank">
                    <h2>Global Tropics Hazards Outlook</h2>
                    <img class="weather-image" src="https://www.cpc.ncep.noaa.gov/products/precip/CWlink/ghaz/gth_full.png" alt="Global Tropics Hazards and Benefits Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.cpc.ncep.noaa.gov/products/precip/CWlink/ghaz/gth_full_TConly.png" target="_blank">
                    <h2>Tropical Cyclone Outlook (Weeks 1-2)</h2>
                    <img class="weather-image" src="https://www.cpc.ncep.noaa.gov/products/precip/CWlink/ghaz/gth_full_TConly.png" alt="Tropical Cyclone Formation Outlook">
                </a>
            </div>
        </div>
        
        <hr class="section-divider">

        <!-- Section 4: Severe Weather Outlooks -->
        <h2 class="section-header">Severe Weather Outlooks</h2>
        <div class="image-grid">
            <!-- National -->
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/outlook/day1otlk.gif" target="_blank">
                    <h2>National Outlook - Day 1</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/outlook/day1otlk.gif" alt="Day 1 Convective Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/outlook/day2otlk.gif" target="_blank">
                    <h2>National Outlook - Day 2</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/outlook/day2otlk.gif" alt="Day 2 Convective Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/outlook/day3otlk.gif" target="_blank">
                    <h2>National Outlook - Day 3</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/outlook/day3otlk.gif" alt="Day 3 Convective Outlook">
                </a>
            </div>
            <!-- Regional -->
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/partners/outlooks/region/SR/" target="_blank">
                    <h2>Southern Region Outlook - Day 1</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/partners/outlooks/region/images/SR_swody1.png" alt="Southern Region Day 1 Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/partners/outlooks/region/SR/" target="_blank">
                    <h2>Southern Region Outlook - Day 2</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/partners/outlooks/region/images/SR_swody2.png" alt="Southern Region Day 2 Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/partners/outlooks/region/SR/" target="_blank">
                    <h2>Southern Region Outlook - Day 3</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/partners/outlooks/region/images/SR_swody3.png" alt="Southern Region Day 3 Outlook">
                </a>
            </div>
            <!-- Local -->
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/partners/outlooks/cwa/EWX/" target="_blank">
                    <h2>Local Outlook - Day 1</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/partners/outlooks/cwa/images/EWX_swody1.png" alt="Local CWA Day 1 Severe Weather Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/partners/outlooks/cwa/EWX/" target="_blank">
                    <h2>Local Outlook - Day 2</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/partners/outlooks/cwa/images/EWX_swody2.png" alt="Local CWA Day 2 Severe Weather Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/partners/outlooks/cwa/EWX/" target="_blank">
                    <h2>Local Outlook - Day 3</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/partners/outlooks/cwa/images/EWX_swody3.png" alt="Local CWA Day 3 Severe Weather Outlook">
                </a>
            </div>
        </div>

        <hr class="section-divider">

        <!-- Section 5: Severe Weather Hazard Probabilities -->
        <h2 class="section-header">Severe Weather Hazard Probabilities</h2>
        <div class="image-grid">
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/outlook/day1probotlk_torn.gif" target="_blank">
                    <h2>Tornado Probability - Day 1</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/outlook/day1probotlk_torn.gif" alt="Tornado Probability">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/outlook/day1probotlk_wind.gif" target="_blank">
                    <h2>Damaging Wind Probability - Day 1</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/outlook/day1probotlk_wind.gif" alt="Damaging Wind Probability">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/outlook/day1probotlk_hail.gif" target="_blank">
                    <h2>Hail Probability - Day 1</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/outlook/day1probotlk_hail.gif" alt="Hail Probability">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/outlook/day2probotlk_torn.gif" target="_blank">
                    <h2>Tornado Probability - Day 2</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/outlook/day2probotlk_torn.gif" alt="Tornado Probability Day 2">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/outlook/day2probotlk_wind.gif" target="_blank">
                    <h2>Damaging Wind Probability - Day 2</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/outlook/day2probotlk_wind.gif" alt="Damaging Wind Probability Day 2">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/outlook/day2probotlk_hail.gif" target="_blank">
                    <h2>Hail Probability - Day 2</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/outlook/day2probotlk_hail.gif" alt="Hail Probability Day 2">
                </a>
            </div>
        </div>
        
        <hr class="section-divider">

        <!-- Section 6: National Forecasts & Hazards -->
        <h2 class="section-header">National Forecasts & Hazards</h2>
        <div class="image-grid">
            <div class="grid-item">
                <a href="https://www.wpc.ncep.noaa.gov/sfc/usfntsfc21wbg.gif" target="_blank">
                    <h2>Current Frontal Positions</h2>
                    <img class="weather-image" src="https://www.wpc.ncep.noaa.gov/sfc/usfntsfc21wbg.gif" alt="Current Frontal Positions">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.wpc.ncep.noaa.gov/basicwx/bwxloop_ndfd.html" target="_blank">
                    <h2>48-Hour Surface Forecast Loop</h2>
                    <img class="weather-image" src="https://www.wpc.ncep.noaa.gov/basicwx/92fndfd.gif" alt="48-Hour Surface Forecast Loop">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.wpc.ncep.noaa.gov/noaa/noaad1.gif" target="_blank">
                    <h2>Surface Analysis - Day 1</h2>
                    <img class="weather-image" src="https://www.wpc.ncep.noaa.gov/noaa/noaad1.gif" alt="WPC Surface Analysis Day 1">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.wpc.ncep.noaa.gov/noaa/noaad2.gif" target="_blank">
                    <h2>Surface Analysis - Day 2</h2>
                    <img class="weather-image" src="https://www.wpc.ncep.noaa.gov/noaa/noaad2.gif" alt="WPC Surface Analysis Day 2">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.wpc.ncep.noaa.gov/noaa/noaad3.gif" target="_blank">
                    <h2>Surface Analysis - Day 3</h2>
                    <img class="weather-image" src="https://www.wpc.ncep.noaa.gov/noaa/noaad3.gif" alt="WPC Surface Analysis Day 3">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.wpc.ncep.noaa.gov/qpf/ero.shtml" target="_blank">
                    <h2>Excessive Rainfall - Day 1</h2>
                    <img class="weather-image" src="https://www.wpc.ncep.noaa.gov/qpf/94ewbg.gif" alt="Day 1 Excessive Rainfall Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.wpc.ncep.noaa.gov/qpf/ero.shtml" target="_blank">
                    <h2>Excessive Rainfall - Day 2</h2>
                    <img class="weather-image" src="https://www.wpc.ncep.noaa.gov/qpf/98ewbg.gif" alt="Day 2 Excessive Rainfall Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.wpc.ncep.noaa.gov/threats/threats.php" target="_blank">
                    <h2>Days 3-7 Hazards Outlook</h2>
                    <img class="weather-image" src="https://www.wpc.ncep.noaa.gov/threats/final/hazards_d3_7_contours.png" alt="WPC Days 3-7 Hazards Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/fire_wx/" target="_blank">
                    <h2>Fire Weather Outlook - Day 1</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/fire_wx/day1otlk_fire.gif" alt="SPC Day 1 Fire Weather Outlook">
                </a>
            </div>
            <div class="grid-item">
                <a href="https://droughtmonitor.unl.edu/" target="_blank">
                    <h2>U.S. Drought Monitor</h2>
                    <img class="weather-image" src="https://droughtmonitor.unl.edu/data/png/current/current_usdm.png" alt="U.S. Drought Monitor">
                </a>
            </div>
        </div>

        <hr class="section-divider">

        <!-- Section 7: Discussions & Reports -->
        <h2 class="section-header">Discussions & Reports</h2>
        <div class="image-grid">
             <div class="grid-item">
                <h2>Area Forecast Discussion</h2>
                <iframe src="https://kamala.cod.edu/tx/latest.fxus64.KEWX.html" title="NWS Austin/San Antonio Area Forecast Discussion"></iframe>
            </div>
            <div class="grid-item">
                <h2>Short-Range National Forecast</h2>
                <iframe src="https://kamala.cod.edu/HPC/latest.fxus01.KWBC.html" title="WPC National Storm Summary Discussion"></iframe>
            </div>
            <div class="grid-item">
                <h2>Extended Forecast Discussion</h2>
                <iframe src="https://kamala.cod.edu/HPC/latest.fxus02.KWNH.html" title="WPC Extended Forecast Discussion"></iframe>
            </div>
             <div class="grid-item">
                <a href="https://www.wpc.ncep.noaa.gov/metwatch/metwatch_mpd.php" target="_blank">
                    <h2>Mesoscale Precipitation Discussions</h2>
                    <img class="weather-image" src="https://www.wpc.ncep.noaa.gov/metwatch/latest_mdmap.gif" alt="WPC Mesoscale Precipitation Discussions Map">
                </a>
            </div>
             <div class="grid-item">
                <a href="https://www.spc.noaa.gov/climo/reports/today.html" target="_blank">
                    <h2>Today's Storm Reports</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/climo/reports/today.gif" alt="Today's Storm Reports">
                </a>
            </div>
             <div class="grid-item">
                <a href="https://www.spc.noaa.gov/products/wwa/" target="_blank">
                    <h2>National Hazard Map</h2>
                    <img class="weather-image" src="https://forecast.weather.gov/wwamap/png/US.png" alt="NWS National Hazard Map">
                </a>
            </div>
             <div class="grid-item">
                <a href="https://www.spc.noaa.gov/" target="_blank">
                    <h2>SPC Activity Loop</h2>
                    <img class="weather-image" src="https://www.spc.noaa.gov/products/activity_loop.gif" alt="SPC Activity Loop">
                </a>
            </div>
        </div>

    </div>

    <footer class="footer">
        <p>This is a non-commercial dashboard for the Vizcaya community. All images are provided by and linked directly from the National Weather Service (NWS), Storm Prediction Center (SPC), and NOAA.</p>
    </footer>

    <!-- ===== JAVASCRIPT FOR AUTO-UPDATE AND TIME ===== -->
    <script>
        // HOURLY FORECAST STRIP SCRIPT
        function updateHourlyForecast() {
            const lat = 30.5871;
            const lon = -97.641;
            const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;

            fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m,precipitation,weathercode&temperature_unit=fahrenheit&forecast_days=1&timezone=${timezone}`)
              .then(res => res.json())
              .then(data => {
                const now = new Date();
                const forecastDiv = document.getElementById('forecast-strip');
                forecastDiv.innerHTML = ''; // Clear "Loading..."

                const hourly = data.hourly;
                const hourlyTimes = hourly.time.map(t => new Date(t));
                let startIndex = hourlyTimes.findIndex(forecastTime => forecastTime > now);

                if (startIndex === -1) { startIndex = hourly.time.length -1; }

                for (let i = 0; i < 12 && (startIndex + i) < hourly.time.length; i++) {
                  const index = startIndex + i;
                  const time = new Date(hourly.time[index]);
                  const hour = time.toLocaleTimeString([], { hour: 'numeric', hour12: true });
                  const temp = Math.round(hourly.temperature_2m[index]);
                  const precip = hourly.precipitation[index];
                  const code = getIcon(hourly.weathercode[index], precip);
                  const rainChance = estimateRainChance(precip);

                  const block = document.createElement('div');
                  block.className = 'hour-block';
                  block.innerHTML = `
                    <div class="time">${hour}</div>
                    <div class="icon">${icon}</div>
                    <div class="temp">${temp}¬∞F</div>
                    <div class="rain">${rainChance}% rain</div>
                  `;
                  forecastDiv.appendChild(block);
                }
              }).catch(error => {
                  document.getElementById('forecast-strip').textContent = 'Could not load hourly forecast.';
                  console.error("Hourly forecast error:", error);
              });
        }

        function getIcon(code, precip) {
            if (precip > 0.2) return 'üåßÔ∏è';
            if (code === 0) return '‚òÄÔ∏è';
            if (code === 1 || code === 2) return '‚õÖ';
            if (code === 3) return '‚òÅÔ∏è';
            if (code >= 45 && code <= 48) return 'üå´Ô∏è';
            if (code >= 51 && code <= 67) return 'üå¶Ô∏è';
            if (code >= 71 && code <= 77) return '‚ùÑÔ∏è';
            if (code >= 80 && code <= 82) return 'üåßÔ∏è';
            if (code >= 95) return '‚õàÔ∏è';
            return '‚ùì';
        }

        function estimateRainChance(mm) {
            if (mm === 0) return 0;
            if (mm < 0.2) return 20;
            if (mm < 1.0) return 50;
            if (mm < 2.5) return 70;
            return 90;
        }

        // TIME AND SUN DATA SCRIPT
        function updateTimeAndSun() {
            const lat = 30.6476;
            const lon = -97.6863;
            const now = new Date();
            
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true, timeZone: 'America/Chicago' };
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('en-US', timeOptions);
            document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', dateOptions);

            const times = SunCalc.getTimes(now, lat, lon);
            const sunrise = times.sunrise.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true });
            const sunset = times.sunset.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true });
            
            const dayLengthMs = times.sunset - times.sunrise;
            const dayLengthHours = Math.floor(dayLengthMs / 3600000);
            const dayLengthMinutes = Math.round((dayLengthMs % 3600000) / 60000);

            document.getElementById('sunInfo').innerHTML = `Sunrise: ${sunrise} ¬†¬†¬† Sunset: ${sunset} ¬†¬†¬† Day Length: ${dayLengthHours}h ${dayLengthMinutes}m`;
        }

        // SEASONS COUNTDOWN SCRIPT
        function updateSeasons() {
            const now = new Date();
            const year = now.getFullYear();

            const seasons = [
                { name: "Spring", date: new Date(Date.UTC(year, 2, 20, 3, 6)) },
                { name: "Summer", date: new Date(Date.UTC(year, 5, 20, 20, 51)) },
                { name: "Fall", date: new Date(Date.UTC(year, 8, 22, 12, 44)) },
                { name: "Winter", date: new Date(Date.UTC(year, 11, 21, 9, 20)) }
            ];
            const nextYearSeasons = [{ name: "Spring", date: new Date(Date.UTC(year + 1, 2, 20, 9, 2)) }];

            const dateFormatOptions = { month: 'long', day: 'numeric' };
            document.getElementById('springDate').textContent = seasons[0].date.toLocaleDateString('en-US', dateFormatOptions);
            document.getElementById('summerDate').textContent = seasons[1].date.toLocaleDateString('en-US', dateFormatOptions);
            document.getElementById('fallDate').textContent = seasons[2].date.toLocaleDateString('en-US', dateFormatOptions);
            document.getElementById('winterDate').textContent = seasons[3].date.toLocaleDateString('en-US', dateFormatOptions);

            let nextSeason = seasons.find(season => season.date > now);
            if (!nextSeason) {
                nextSeason = nextYearSeasons[0];
            }

            const diff = nextSeason.date - now;
            const days = Math.ceil(diff / (1000 * 60 * 60 * 24));
            document.getElementById('nextSeasonCountdown').textContent = `${days} days until ${nextSeason.name}`;
        }

        // IMAGE REFRESH SCRIPT
        function refreshImages() {
            const images = document.querySelectorAll('.weather-image');
            const timestamp = new Date().getTime();
            images.forEach(image => {
                let baseSrc = image.src.split('?')[0];
                image.src = baseSrc + '?t=' + timestamp;
            });
        }

        // INITIALIZE AND SET INTERVALS
        window.onload = function() {
            updateTimeAndSun();
            updateSeasons();
            updateHourlyForecast();
            setInterval(updateTimeAndSun, 1000); // Update time every second
            setInterval(updateSeasons, 3600000); // Update seasons every hour

            refreshImages();
            setInterval(refreshImages, 300000); // Update images every 5 minutes
            setInterval(updateHourlyForecast, 900000); // Update hourly every 15 minutes
        };
    </script>
    <!-- ===================================== -->

</body>
</html>


